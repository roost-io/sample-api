# ********RoostGPT********

# Test generated by RoostGPT for test weatherTest using AI Type Claude AI and AI Model claude-3-5-sonnet-20241022
# 
# Feature file generated for /timezone.json_get for http method type GET 
# RoostTestHash=df6b1e5ce9
# 
# 

# ********RoostGPT********
Feature: Time Zone API Tests

  Background:
    * def urlBase = karate.properties['API_HOST']
    * url urlBase
    * def authToken = karate.properties['key']
    * configure headers = { 'Accept': 'application/json' }

  Scenario Outline: Get timezone information for valid locations
    Given path '/v1/timezone.json'
    And param key = authToken
    And param q = location
    When method GET
    Then status 200
    And match response ==
      """
      {
          name: '#string',
          region: '#string', 
          country: '#string',
          lat: '#number',
          lon: '#number',
          tz_id: '#string',
          localtime_epoch: '#number',
          localtime: '#string'
      }
      """
    And match response.lat >= -90 && response.lat <= 90
    And match response.lon >= -180 && response.lon <= 180
    And match response.localtime_epoch > 0

    Examples:
      | read('timezone.json_get.csv') |

  Scenario: Get timezone information without location parameter
    Given path '/v1/timezone.json'
    And param key = authToken
    When method GET
    Then status 400
    And match response ==
      """
      {
          code: '#number',
          message: '#string'
      }
      """
    And match response.code == 1003
    And match response.message == 'Parameter \'q\' not provided.'

  Scenario: Get timezone information with invalid API key
    Given path '/v1/timezone.json'
    And param key = 'invalid_key'
    And param q = 'London'
    When method GET
    Then status 401
    And match response ==
      """
      {
          code: '#number',
          message: '#string'
      }
      """
    And match response.code == 2006
    And match response.message == 'API key provided is invalid'

  Scenario: Get timezone information with invalid location
    Given path '/v1/timezone.json'
    And param key = authToken
    And param q = 'InvalidLocationXYZ123'
    When method GET
    Then status 400
    And match response ==
      """
      {
          code: '#number',
          message: '#string'
      }
      """
    And match response.code == 1006
    And match response.message == 'No location found matching parameter \'q\''

  Scenario: Get timezone information with exceeded API quota
    Given path '/v1/timezone.json'
    And param key = authToken
    And param q = 'London'
    When method GET
    Then status 403
    And match response ==
      """
      {
          code: '#number',
          message: '#string'
      }
      """
    And match response.code == 2007
    And match response.message == 'API key has exceeded calls per month quota.'

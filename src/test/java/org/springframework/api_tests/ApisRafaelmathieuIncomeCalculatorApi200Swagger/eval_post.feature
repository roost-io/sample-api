# ********RoostGPT********

# Test generated by RoostGPT for test karate-api-test using AI Type Azure Open AI and AI Model roostgpt-4-32k
# 
# Feature file generated for /eval_post for http method type POST 
# RoostTestHash=a93be584a8
# 
# 

# ********RoostGPT********
Feature: Evaluation Income Calculator API

  Background:
    * def urlBase = karate.properties['url.base'] || karate.get('urlBase', 'http://localhost:4010')
    * url urlBase
    * configure headers = { Authorization: #(karate.properties['AUTH_TOKEN']) }

  Scenario Outline: Evaluate Income Calculator Request (Valid Payload)
    Given path '/eval'
    And param includePdfFindings = <includePdfFindings>
    And request """ 
    {
      "businessStructure": "soleProprietorship", 
      "taxData": [
        {
          "year": "2022",
          "formId": "1040",
          "fields": [
            {
              "id": "someFieldName",
              "isEmpty": false,
              "value": "someValue"
            }
          ]
        }
      ]
    }
    """
    When method POST
    Then status 200
    And match response.requestId == '#string'
    And match response.status == '#string'
    And match response.timestamp == '#date-time'
    And match response.totalQualifiedIncome == '#number'
    And match response.monthlyQualifiedIncome == '#number'
    And match response.numberOfMonths == '#integer'
    And match response.incomeType == '#string'
    And match response.businessStructure == '#string'
    And match response.totalQualifiedIncome == '#number'
    And match response.documentationLevels == '#[]'
    And match response.taxYears == '#[]'
    And match response.duData == '#object'

    Examples:
      | includePdfFindings |
      | true               |
      | false              |

  Scenario Outline: Evaluate Income Calculator Request (Invalid Payload)
    Given path '/eval'
    And param includePdfFindings = <includePdfFindings>
    And request """<invalidPayload>"""
    When method POST
    Then status <status>
    And match response.errorCode == '#integer'
    And match response.errorMessage == '#string'

    Examples:
      | includePdfFindings | invalidPayload                            | status |
      | true               | { "businessStructure": null }            | 400    |
      | false              | { "taxData": [] }                        | 400    |

  Scenario Outline: Invalid HTTP Methods Test
    Given path '/eval'
    When method <httpMethod>
    Then status <status>

    Examples:
      | httpMethod | status |
      | GET        | 405    |
      | PUT        | 405    |
      | DELETE     | 405    |

  Scenario: Missing Authorization Header
    * configure headers = {}
    Given path '/eval'
    And param includePdfFindings = false
    And request """ 
    {
      "businessStructure": "soleProprietorship", 
      "taxData": [
        {
          "year": "2022",
          "formId": "1040",
          "fields": [
            {
              "id": "someFieldName",
              "isEmpty": false,
              "value": "someValue"
            }
          ]
        }
      ]
    }
    """
    When method POST
    Then status 403

  Scenario: Internal Server Error Scenario
    Given path '/eval'
    And param includePdfFindings = false
    And request """ 
    {
      "businessStructure": "sCorp", 
      "taxData": [
        {
          "year": "2022",
          "formId": "1040",
          "fields": [
            {
              "id": "someFieldName",
              "isEmpty": true,
              "value": "someValue"
            }
          ]
        }
      ]
    }
    """
    When method POST
    Then status 500

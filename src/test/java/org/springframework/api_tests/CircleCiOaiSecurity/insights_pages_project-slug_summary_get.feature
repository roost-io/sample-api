# ********RoostGPT********

# Test generated by RoostGPT for test api-testing-karate-circleci-OAI-security using AI Type Azure Open AI and AI Model roostgpt-4-32k
# 
# Feature file generated for /insights/pages/{project-slug}/summary_get for http method type GET 
# RoostTestHash=ff247d2d67
# 
# 

# ********RoostGPT********
Feature: CircleCI API Testing - Insights Pages Summary Endpoint

  Background:
    * def urlBase = karate.properties['api_base_url']
    * def token = karate.properties['circle-token']
    * configure headers = { 'Circle-Token': token }

  Scenario Outline: Test Insights Pages Summary Endpoint with Valid Inputs
    Given url urlBase + '/insights/pages/<project-slug>/summary'
    And param reporting-window = <reporting-window>
    And param branches = <branches>
    And param workflow-names = <workflow-names>
    When method GET
    Then status 200
    And match response.org_id == '##string'
    And match response.project_id == '##string'
    And match response.project_data.metrics.total_runs == '#integer'
    And match response.project_data.metrics.total_duration_secs == '#integer'
    And match response.project_data.metrics.total_credits_used == '#integer'
    And match response.project_data.metrics.success_rate == '#number'
    And match response.project_data.trends.total_runs == '#number'
    And match response.project_data.trends.success_rate == '#number'
    And match response.project_workflow_data[*].workflow_name == '#string'
    And match each response.project_workflow_data[*].metrics.total_runs == '#integer'
    And match each response.project_workflow_branch_data[*].trends.success_rate == '#number'
    And match each response.all_branches[*] == '#string'
    And match each response.all_workflows[*] == '#string'

    Examples:
      | read('insights_pages_project-slug_summary_get.csv') |

  Scenario Outline: Test Insights Pages Summary Endpoint with Invalid Inputs
    Given url urlBase + '/insights/pages/<project-slug>/summary'
    And param reporting-window = <reporting-window>
    And param branches = <branches>
    And param workflow-names = <workflow-names>
    When method GET
    Then status <statusCode>
    And match response.message == '##string'

    Examples:
      | project-slug                        | reporting-window | branches            | workflow-names      | statusCode |
      | gh/InvalidOrgID/invalid-project     | last-90-days     | ['main']            | ['test-workflow']   |        404 |
      | gh/CircleCI-Public/api-preview-docs | invalid-window   | ['main', 'feature'] | ['build', 'deploy'] |        400 |

  Scenario: Test Unauthorized Request
    Given url urlBase + '/insights/pages/gh/CircleCI-Public/api-preview-docs/summary'
    * configure headers = {}
    When method GET
    Then status 401
    And match response.message == '##string'

  Scenario: Test Rate Limit Exceeded
    Given url urlBase + '/insights/pages/gh/CircleCI-Public/api-preview-docs/summary'
    And param reporting-window = 'last-90-days'
    And param branches = ['main']
    And param workflow-names = ['build']
    When method GET
    Then status 429
    And match response.message == '##string'

# ********RoostGPT********

# Test generated by RoostGPT for test Karate_Test using AI Type Open AI and AI Model gpt-4o
# 
# Feature file generated for /insights/{project-slug}/flaky-tests_get for http method type GET 
# RoostTestHash=dc5a38e5b0
# 
# 

# ********RoostGPT********
Feature: Insights API - Flaky Tests

  Background:
    * def urlBase = karate.properties['API_HOST']
    * url urlBase
    * configure headers = { Authorization: 'Basic REPLACE_BASIC_AUTH' }

  Scenario Outline: Get flaky tests for a project
    Given path 'insights', '<project-slug>', 'flaky-tests'
    When method GET
    Then status 200
    And match response == '#object'
    And match response contains { 'flaky-tests': '#array', 'total-flaky-tests': '#number' }
    And match response['flaky-tests'] == '#[] object'
    And match response['flaky-tests'][0] contains
      """
      { 
        'workflow-created-at': '#string', 
        'classname': '#string?', 
        'job-number': '#number', 
        'times-flaked': '#number', 
        'source': '#string?', 
        'pipeline-number': '#number', 
        'file': '#string?', 
        'workflow-name': '#string', 
        'job-name': '#string', 
        'workflow-id': '#string', 
        'test-name': '#string' 
      }
      """
    And match response['flaky-tests'][0]['time-wasted'] == '#number'
    And match response['flaky-tests'][0]['pipeline-number'] == '#number'
    And match response['flaky-tests'][0]['job-number'] == '#number'
    And match response['flaky-tests'][0]['times-flaked'] == '#number'

    Examples:
      | read('insights_project-slug_flaky-tests_get.csv') |

  Scenario: Error response for invalid project slug
    Given path 'insights', 'invalid/project/slug', 'flaky-tests'
    When method GET
    Then status 404
    And match response == '#object'
    And match response contains
      """
      { 
        'message': '#string' 
      }
      """

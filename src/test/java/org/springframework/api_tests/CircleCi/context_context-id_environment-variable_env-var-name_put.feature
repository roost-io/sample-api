# ********RoostGPT********

# Test generated by RoostGPT for test karateCircleCIFile using AI Type Claude AI and AI Model claude-3-7-sonnet-20250219
# 
# Feature file generated for /context/{context-id}/environment-variable/{env-var-name}_put for http method type PUT 
# RoostTestHash=a071a14843
# 
# 

# ********RoostGPT********
Feature: Context Environment Variable API

  Background:
    * def urlBase = karate.properties['URL_BASE']
    * def contextId = '12345678-1234-1234-1234-123456789012'
    * def authHeader = { Authorization: 'Basic REPLACE_BASIC_AUTH' }

  Scenario Outline: Add or update an environment variable in a context
    Given url urlBase
    And path 'context', contextId, 'environment-variable', envVarName
    And headers authHeader
    And request { "value": "#(envVarValue)" }
    And header Content-Type = 'application/json'
    When method PUT
    Then status 200
    And match response contains { variable: '#string', created_at: '#string', updated_at: '#string', context_id: '#string' }
    And match response.variable == envVarName
    And match response.created_at == '#regex \\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z'
    And match response.updated_at == '#regex \\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z'
    And match response.context_id == contextId
    And match response.context_id == '#regex [0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'

    Examples:
      | read('context_context-id_environment-variable_env-var-name_put.csv') |

  Scenario: Add environment variable with empty value
    Given url urlBase
    And path 'context', contextId, 'environment-variable', 'EMPTY_VAR'
    And headers authHeader
    And request { "value": "" }
    And header Content-Type = 'application/json'
    When method PUT
    Then status 200
    And match response contains { variable: '#string', created_at: '#string', updated_at: '#string', context_id: '#string' }
    And match response.variable == 'EMPTY_VAR'
    And match response.context_id == contextId

  Scenario: Add environment variable with message response
    Given url urlBase
    And path 'context', contextId, 'environment-variable', 'MESSAGE_VAR'
    And headers authHeader
    And request { "value": "test-value" }
    And header Content-Type = 'application/json'
    When method PUT
    Then status 200
    And match response == { message: '#string' } || response contains { variable: '#string', created_at: '#string', updated_at: '#string', context_id: '#string' }

  Scenario: Add environment variable with invalid context ID
    Given url urlBase
    And path 'context', 'invalid-uuid', 'environment-variable', 'TEST_VAR'
    And headers authHeader
    And request { "value": "test-value" }
    And header Content-Type = 'application/json'
    When method PUT
    Then status 400
    And match response contains { message: '#string' }

  Scenario: Add environment variable with missing value
    Given url urlBase
    And path 'context', contextId, 'environment-variable', 'MISSING_VALUE_VAR'
    And headers authHeader
    And request {}
    And header Content-Type = 'application/json'
    When method PUT
    Then status 400
    And match response contains { message: '#string' }

  Scenario: Add environment variable with unauthorized access
    Given url urlBase
    And path 'context', contextId, 'environment-variable', 'UNAUTHORIZED_VAR'
    And header Content-Type = 'application/json'
    And request { "value": "test-value" }
    When method PUT
    Then status 401
    And match response contains { message: '#string' }
